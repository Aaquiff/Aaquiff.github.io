<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Cross-Site Request Forgery | Aaquiff Ahnaff Rauf</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Cross-Site Request Forgery" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="What is is CSRF?" />
<meta property="og:description" content="What is is CSRF?" />
<link rel="canonical" href="http://localhost:4000/csrf/2020/05/06/cross-site-request-forgery.html" />
<meta property="og:url" content="http://localhost:4000/csrf/2020/05/06/cross-site-request-forgery.html" />
<meta property="og:site_name" content="Aaquiff Ahnaff Rauf" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-06T00:50:05+05:30" />
<script type="application/ld+json">
{"headline":"Cross-Site Request Forgery","dateModified":"2020-05-06T00:50:05+05:30","datePublished":"2020-05-06T00:50:05+05:30","url":"http://localhost:4000/csrf/2020/05/06/cross-site-request-forgery.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/csrf/2020/05/06/cross-site-request-forgery.html"},"description":"What is is CSRF?","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Aaquiff Ahnaff Rauf" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Aaquiff Ahnaff Rauf</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Cross-Site Request Forgery</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-05-06T00:50:05+05:30" itemprop="datePublished">May 6, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="what-is-is-csrf">What is is CSRF?</h1>

<p><strong>Cross-Site Request Forgery(CSRF)</strong> is a web browser based attack that tricks the user to execute operations on a 
different domain than that the current browsing domain. It is used to perform operations unknowingly to the user but could be used for theft of information as well. Imagine you are logged into Facebook and browsing a malicious website at the same time and the attacker knows the request format for a operation that could alter the users account and includes an ajax call in the malicious website that performs the state changing request to Facebook. The browser will send this request along with all cookies related to Facebook as well and hence will seem to be a legitimate request.</p>

<h1 id="protection">Protection</h1>

<p>To protect against CSRF, we need to prove that the request is coming from the form, that we have provided to the user. In order to do this validation we use a token that is embedded into the form page and subsequently sent with the post request to the server. Request(like AJAX) is  sent on form load to receive this token. A question arises here, couldnâ€™t the malicious website do the same to get the token from the server? No! because of Same-Origin policy which defines that the request can only come from the same domain.</p>

<p>There are two methods of implementing protection against CSRF and are explained below.</p>

<h2 id="synchronous-token-pattern">Synchronous Token Pattern</h2>

<p>In this method, the server generates a token for each session and stores it in a key value like store. The next time the form loads, it requests the token from the server to which the server responds and the browser embeds the token in the form. Subsequently, when the form is posted, the token is sent along with the form data. The server then validates the received token against the token in the server that maps to the session id to check if it is from the valid form.</p>

<p>This can help avoid CSRF However when there are huge heap of connections open, the server needs to maintain these tokens and this would be problematic in terms of storage and performance. To avoid the need for the server to store tokens, an alternative pattern called Double Submit Cookie Pattern is used.</p>

<p>Sample of a Java Web Application protected with Synchronous Token Pattern can be found <a href="https://github.com/Aaquiff/csrf-synchronizer-token-pattern-example">here</a>.</p>

<h2 id="double-submit-cookie-pattern">Double Submit Cookie Pattern</h2>

<p>This, instead of storing the token in the server, creates a cookie for the token in the browser. Now the browser has the CSRF token embedded in the form as well as a cookie containing the same CSRF token. When the data is posted to the server, the CSRF token in the cookie is sent along with the token in the form data.The server, then validates that both token values are equal to confirm that the request is coming from the legitimate site.</p>

<p>Sample for a Java Web Application protected with Double Submit Cookie Pattern can be found <a href="https://github.com/Aaquiff/csrf-double-submit-cookie-example">here</a>.</p>

  </div><a class="u-url" href="/csrf/2020/05/06/cross-site-request-forgery.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Aaquiff Ahnaff Rauf</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Aaquiff Ahnaff Rauf</li><li><a class="u-email" href="mailto:aaquiff@gmail.com">aaquiff@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Aaquiff"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Aaquiff</span></a></li><li><a href="https://www.twitter.com/Aaquiff"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">Aaquiff</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
